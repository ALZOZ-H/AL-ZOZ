<!-- offers.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AL ZOZ â€” Hot Offers</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="sidebar">
    <div class="logo"><img src="logo.png" alt="AL ZOZ"></div>
    <a href="index.html">ğŸ›’ Products</a>
    <a href="offers.html">ğŸ”¥ Hot Offers</a>
    <a href="contact.html">ğŸ“ Contact</a>
    <a href="dashboard.html" class="admin-only">ğŸ“Š Dashboard</a>
    <a href="admin.html" class="admin-only">âš™ï¸ Manage Products</a>
    <a href="#" id="logoutBtn" class="logout">ğŸšª Logout</a>
  </div>

  <div class="content">
    <h1>Hot Offers</h1>
    <div id="offersGrid" class="product-grid"></div>
  </div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
  const firebaseConfig = {
    apiKey: "AIzaSyBMcvOHM65rOqpZbwqSGI7LJm6lNc0dPo4",
    authDomain: "al-zoz-store.firebaseapp.com",
    projectId: "al-zoz-store",
    storageBucket: "al-zoz-store.firebasestorage.app",
    messagingSenderId: "977135794801",
    appId: "1:977135794801:web:43aae20e57879b8e9579d0",
    measurementId: "G-FG212CG4VE"
  };
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  onAuthStateChanged(auth, user=>{
    document.getElementById('logoutBtn').style.display = user ? 'block' : 'none';
    if(user && user.email && user.email.toLowerCase() === 'alihomekh@gmail.com') document.querySelectorAll('.admin-only').forEach(el=>el.style.display='block');
  });
  document.getElementById('logoutBtn').addEventListener('click', ()=> signOut(auth).then(()=> location.href='login.html'));

  (async function loadOffers(){
    const q = query(collection(db,'products'), where('offer','==', true));
    const snap = await getDocs(q);
    const grid = document.getElementById('offersGrid'); grid.innerHTML='';
    if(snap.empty){ grid.innerHTML = '<div class="card">No hot offers right now.</div>'; return; }
    snap.forEach(docSnap=>{
      const p = docSnap.data(); const id = docSnap.id; const img = (p.images&&p.images[0])?p.images[0]:(p.image||'https://picsum.photos/seed/placeholder/800/600');
      const el = document.createElement('div'); el.className='product-card';
      el.innerHTML = `<a href="product.html?id=${id}" style="text-decoration:none;color:inherit"><img src="${img}" alt=""><div class="pbody"><div class="product-name">${p.name}</div><div class="product-price">$${p.price}</div><div class="badge-offer">HOT</div></div></a>`;
      grid.appendChild(el);
    });
  })();
</script>
</body>
</html>
