<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AL ZOZ — Login</title>
  <style>
    body{font-family:Inter,Arial,sans-serif;background:#f5f7fb;margin:0;display:flex;align-items:center;justify-content:center;height:100vh}
    .card{background:#fff;padding:28px;border-radius:12px;box-shadow:0 8px 30px rgba(12,20,40,0.08);width:340px}
    h1{margin:0 0 10px;font-size:20px}
    .muted{color:#586069;font-size:13px;margin-bottom:14px}
    input{width:100%;padding:10px;margin:8px 0;border:1px solid #e6e9ee;border-radius:8px;box-sizing:border-box}
    .btn{width:100%;padding:10px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
    .btn-primary{background:#ff6600;color:white}
    .btn-ghost{background:white;border:1px solid #dbe3f0;color:#12263a}
    .or{display:flex;align-items:center;gap:8px;margin:12px 0;color:#93a0b3;font-size:13px}
    .or:before,.or:after{content:"";flex:1;height:1px;background:#eef2f6}
    .google-btn{display:flex;align-items:center;gap:10px;justify-content:center}
    .google-icon{width:18px;height:18px;display:inline-block}
    #msg{min-height:18px;color:#cf2333;margin-top:8px;font-size:13px}
    .small{font-size:12px;color:#6b7280;margin-top:8px;text-align:center}
  </style>
</head>
<body>
  <div class="card">
    <h1>AL ZOZ</h1>
    <div class="muted">Login or register to enter the store</div>

    <input id="email" type="email" placeholder="Email" autocomplete="email" />
    <input id="password" type="password" placeholder="Password" autocomplete="current-password" />

    <button id="loginBtn" class="btn btn-primary">Login</button>
    <button id="registerBtn" class="btn btn-ghost" style="margin-top:8px">Register</button>

    <div class="or"> <span>or</span> </div>

    <button id="googleBtn" class="btn btn-ghost google-btn">
      <span class="google-icon" aria-hidden="true">
        <!-- simple Google SVG icon -->
        <svg viewBox="0 0 533.5 544.3" xmlns="http://www.w3.org/2000/svg" width="18" height="18">
          <path fill="#4285F4" d="M533.5 278.4c0-17.6-1.6-34.6-4.7-51.1H272v96.6h147.1c-6.4 34.9-25.6 64.5-54.5 84.3v69h88C497.5 420.1 533.5 353.2 533.5 278.4z"/>
          <path fill="#34A853" d="M272 544.3c73.7 0 135.6-24.3 180.8-66.1l-88-69c-24.5 16.5-56 26.1-92.8 26.1-71 0-131.3-47.9-152.9-112.2h-90.6v70.5C76.1 486.6 167.6 544.3 272 544.3z"/>
          <path fill="#FBBC05" d="M119.1 322.0c-10.9-32.9-10.9-68.2 0-101.1V150.4h-90.6C6.9 195.3 0 233.9 0 272c0 38.1 6.9 76.6 28.5 121.6l90.6-72.6z"/>
          <path fill="#EA4335" d="M272 108.7c38.9 0 73.9 13.4 101.4 39.6l75.9-75.9C408.6 23.9 346.7 0 272 0 167.6 0 76.1 57.7 28.5 150.4l90.6 70.5C140.7 156.6 201 108.7 272 108.7z"/>
        </svg>
      </span>
      Login with Google
    </button>

    <div id="msg"></div>
    <div class="small">If you register with <strong>alihomekh@gmail.com</strong>, you'll be the admin account.</div>
  </div>

  <!-- Firebase (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

  <script>
    // ---------- FIREBASE CONFIG ----------
    const firebaseConfig = {
      apiKey: "AIzaSyBMcvOHM65rOqpZbwqSGI7LJm6lNc0dPo4",
      authDomain: "al-zoz-store.firebaseapp.com",
      projectId: "al-zoz-store",
      storageBucket: "al-zoz-store.firebasestorage.app",
      messagingSenderId: "977135794801",
      appId: "1:977135794801:web:43aae20e57879b8e9579d0",
      measurementId: "G-FG212CG4VE"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // ---------- UI ----------
    const emailEl = document.getElementById('email');
    const passEl  = document.getElementById('password');
    const msgEl   = document.getElementById('msg');
    const loginBtn = document.getElementById('loginBtn');
    const regBtn   = document.getElementById('registerBtn');
    const googleBtn = document.getElementById('googleBtn');

    function showMsg(text, err){
      msgEl.style.color = err ? '#cf2333' : '#1b7a3b';
      msgEl.textContent = text;
    }

    // enable Enter key to trigger login
    passEl.addEventListener('keydown', function(e){
      if(e.key === 'Enter') login();
    });
    emailEl.addEventListener('keydown', function(e){
      if(e.key === 'Enter') login();
    });

    // ---------- Auth actions ----------
    async function register(){
      const email = emailEl.value.trim();
      const pass = passEl.value;
      if(!email || !pass){ showMsg('Enter email and password', true); return; }
      showMsg('Processing...');
      try{
        await auth.createUserWithEmailAndPassword(email, pass);
        showMsg('Registered! Redirecting...');
        // After signup, user will be logged in automatically — redirect based on role
      }catch(e){
        showMsg(e.message, true);
      }
    }

    async function login(){
      const email = emailEl.value.trim();
      const pass = passEl.value;
      if(!email || !pass){ showMsg('Enter email and password', true); return; }
      showMsg('Signing in...');
      try{
        await auth.signInWithEmailAndPassword(email, pass);
        showMsg('Signed in! Redirecting...');
        // redirect handled in onAuthStateChanged
      }catch(e){
        showMsg(e.message, true);
      }
    }

    async function googleSign(){
      const provider = new firebase.auth.GoogleAuthProvider();
      try{
        await auth.signInWithPopup(provider);
      }catch(e){
        showMsg(e.message, true);
      }
    }

    // Button handlers
    loginBtn.addEventListener('click', login);
    regBtn.addEventListener('click', register);
    googleBtn.addEventListener('click', googleSign);

    // Auth state watcher — redirect after login
    auth.onAuthStateChanged(user => {
      if(user){
        const email = user.email || '';
        // If admin email, go to admin panel; otherwise load store
        if(email.toLowerCase() === 'alihomekh@gmail.com') {
          window.location.href = 'admin.html';
        } else {
          window.location.href = 'index.html';
        }
      }
    });

    // helpful note: clear message on input focus
    [emailEl, passEl].forEach(i=> i.addEventListener('input', ()=> msgEl.textContent=''));
  </script>
</body>
</html>
